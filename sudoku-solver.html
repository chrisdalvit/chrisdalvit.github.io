<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Beau+Rivage&family=Open+Sans:wght@300;400;500;800&family=Parisienne&family=Sometype+Mono:ital,wght@0,400..700;1,400..700&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Beau+Rivage&family=Heebo:wght@100..900&family=Parisienne&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="./_app/immutable/assets/0.s4a-y5vk.css" rel="stylesheet">
		<link href="./_app/immutable/assets/4.SYVF0tst.css" rel="stylesheet">
		<link href="./_app/immutable/assets/GirdLayout.QSv4R-U8.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/entry/start.CR1R6--2.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/entry.CXrdnBVy.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/scheduler.CBrFld69.js">
		<link rel="modulepreload" href="./_app/immutable/entry/app.DMU814DA.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index.sRGoKq7I.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/0.C41nc5p_.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/4.BXr2JSOs.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/GirdLayout.CdM7nvXq.js"><!-- HEAD_svelte-1fnoeo3_START --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-tomorrow.min.css" integrity="sha512-kSwGoyIkfz4+hMo5jkJngSByil9jxJPKbweYec/UgS+S1EgE45qm4Gea7Ks2oxQ7qiYyyZRn66A9df2lMtjIsw==" crossorigin="anonymous" referrerpolicy="no-referrer"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js" integrity="sha512-UOoJElONeUNzQbbKQbjldDf9MwOHqxNz49NNJJ1d90yp+X9edsHyJoAs6O4K19CZGaIdjI5ohK+O2y5lBTW6uQ==" crossorigin="anonymous" referrerpolicy="no-referrer" data-svelte-h="svelte-6onnu2"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-python.min.js" integrity="sha512-3qtI9+9JXi658yli19POddU1RouYtkTEhTHo6X5ilOvMiDfNvo6GIS6k2Ukrsx8MyaKSXeVrnIWeyH8G5EOyIQ==" crossorigin="anonymous" referrerpolicy="no-referrer" data-svelte-h="svelte-1t6dhnn"></script><!-- HEAD_svelte-1fnoeo3_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">  <div class="container svelte-1c0zvtr"><nav class="svelte-1c0zvtr" data-svelte-h="svelte-1a6kb85"><a href="/" data-sveltekit-reload class="svelte-1c0zvtr">Home</a> <a href="/about" data-sveltekit-reload class="svelte-1c0zvtr">About</a></nav> <div class="frame svelte-q8kqk1"> <div></div>  <div class="article svelte-tvt0jz" slot="center"><h1 class="svelte-tvt0jz">Sudoku Solver</h1> <p class="article-date svelte-tvt0jz">22. August 2024</p> <p class="svelte-uf7wis">This blog post describes step-by-step how to implement a real-time Sudoku solver in Python using OpenCV and PyTorch. Beside describing the implementation step-by-step, the blog post also aims to explain the theoretical foundations of the applied concepts. Implementing a real-time Sudoku solver is one of the most popular beginner projects in Computer Vision and there already exist many tutorials on the internet. But most tutorials I read don&#39;t go into the theoretical details (let me know if I missed a tutorial that does). With this blog post I want to fill this gap. I assume you know what a Sudoku puzzle is and have some knowledge of Python. You can check out the code on Github. </p> <figure data-svelte-h="svelte-1oydq0b"><div class="image-container svelte-9k87am"><img src="/solver_demo.gif" alt="GIF showing an example of the real-time Sudoku solver"></div> <figcaption>A demo of the implemented Sudoku solver</figcaption></figure> <div><h3 id="overview" class="section-title svelte-5tuic4">Overview</h3> <p data-svelte-h="svelte-10uegj2">Before diving into the details, I think it is a good idea to start with an overview over the whole process. Let&#39;s take a look at the function that basically does all the work. The following code snippet processes one frame. Processing a video is then simply calling this function on every frame.</p>  <pre class="language-python svelte-4o8q87"><code data-svelte-h="svelte-13pp319">def process_frame(img, model):
    prep_img = preprocessing(img)
    square, corners = find_sudoku_square(prep_img)
    cells = extract_cells(square)
    preds = []
    for c in cells:
        pred = model(c)
        preds.append(pred)

    sudoku = Sudoku(preds)
    solution = sudoku.solve()
    I = draw_digits(img, sudoku, solution, corners)
    return blend_images(I, img, I)</code> 
</pre> <p data-svelte-h="svelte-echguf">The function takes an image and a neural network as input. The first step is to preprocess the image. The goal of preprocessing is modifying the image in a way that simplifies the other steps. The preprocessed image is then used to extract the Sudoku grid. The function <code>find_sudoku_square</code> returns the rectangular image patch containing the Sudoku grid and the coordinates of the grid corners. The corners are later needed for projecting the solution onto the original image. As next step we apply <code>extract_cells</code> to split up the Sudoku grid into single cells. In the loop we classify the digits in the cells (or if they are empty) using the neural network. The collected predicitons are put inside a <code>Sudoku</code> object to compute a solution for the puzzle. <code>draw_digits</code> draws the solution onto the image patch and applies a perspective projection to the patch using the corners. As last step the projected Sudoku solution is blended with the original image.</p> <p data-svelte-h="svelte-sikcnv">Don&#39;t worry if something is not clear yet. We will see how things work in the following sections. At this point we have a rough idea how the Sudoku solver should work. The main point is the we find the Sudoku gird, split it up, predict the digits, solve the puzzle and print the solution back onto the output image. In case of a video we do this for process for every frame.</p> </div> <div><h3 id="image-preprocessing" class="section-title svelte-5tuic4">Image Preprocessing</h3> <p>Image Preprocessing
             <span style="display: none;">f : \mathbb{R}^2 \rightarrow \mathbb{R}</span>  <span></span></p> </div> <div><h3 id="sudoku-detection" class="section-title svelte-5tuic4">Sudoku Detection</h3> <p data-svelte-h="svelte-z1r3gu">Sudoku Detection</p> </div> <div><h3 id="cell-extraction" class="section-title svelte-5tuic4">Cell Extraction</h3> <p data-svelte-h="svelte-9mvd7r">Cell Extraction</p> </div> <div><h3 id="digit-recognition" class="section-title svelte-5tuic4">Digit Recognition</h3> <p data-svelte-h="svelte-3s58ny">Digit Recognition</p> </div> <div><h3 id="sudoku-solving" class="section-title svelte-5tuic4">Sudoku Solving</h3> <p data-svelte-h="svelte-1f3rzad">Sudoku Solving</p> </div> <div><h3 id="solution-projection" class="section-title svelte-5tuic4">Solution Projection</h3> <p data-svelte-h="svelte-1x4cwh4">Solution Projection</p> </div> <div><h3 id="conclusion" class="section-title svelte-5tuic4">Conclusion</h3> <p data-svelte-h="svelte-1kl3p5j">Conclusion</p> </div> <script src="https://utteranc.es/client.js" repo="chrisdalvit/chrisdalvit.github.io" issue-term="pathname" label="blog-post-comment" theme="github-light" crossorigin="anonymous" async data-svelte-h="svelte-1mo85zv"></script></div>  <div></div>  </div> </div> 
			
			<script>
				{
					__sveltekit_mdk1tr = {
						base: new URL(".", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("./_app/immutable/entry/start.CR1R6--2.js"),
						import("./_app/immutable/entry/app.DMU814DA.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 4],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
